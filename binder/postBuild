#!/bin/bash

set -ex

wget https://apache.mirror.wearetriple.com/spark/spark-3.1.2/spark-3.1.2-bin-hadoop3.2.tgz
tar -xzf spark-3.1.2-bin-hadoop3.2.tgz
rm spark-3.1.2-bin-hadoop3.2.tgz

yes | conda install -c conda-forge jupyterlab=2.1.2
pip install jupyterlab-spark-ui-tab
jupyter labextension install @acmore/jupyterlab-spark-ui-tab
jupyter serverextension enable --py --sys-prefix spark-ui-tab

wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add - && \
echo "deb http://dl.google.com/linux/chrome/deb/ stable main" > /etc/apt/sources.list.d/google.list && \
apt-get update && \
apt-get install -y google-chrome-stable && \
rm -rf /var/lib/apt/lists/*

EXPOSE 5901
